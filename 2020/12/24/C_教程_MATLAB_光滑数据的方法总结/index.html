<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>MATLAB光滑数据的方法总结 | Zhaohua Tian's Web</title><meta name="author" content="Zhaohua Tian"><meta name="copyright" content="Zhaohua Tian"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MATLAB #DataprocessingMATLAB光滑数据的方法总结对于数据的光滑，我开始理解的不透彻，直接用了一些MATLAB、Python的内置函数，没有理解其内在本质，仔细看了一些技术文章，了解了其基本原理，总结出来，希望以后可以用到 几种常用信号平滑去噪的方法 含普通噪声的数据的光滑普通噪声即随机的噪声，是一些比较随机的波动。我们可以做的只是让这些波动变得平均。要去除背景还得用测量的">
<meta property="og:type" content="article">
<meta property="og:title" content="MATLAB光滑数据的方法总结">
<meta property="og:url" content="https://knifelees3.github.io/2020/12/24/C_%E6%95%99%E7%A8%8B_MATLAB_%E5%85%89%E6%BB%91%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="Zhaohua Tian&#39;s Web">
<meta property="og:description" content="MATLAB #DataprocessingMATLAB光滑数据的方法总结对于数据的光滑，我开始理解的不透彻，直接用了一些MATLAB、Python的内置函数，没有理解其内在本质，仔细看了一些技术文章，了解了其基本原理，总结出来，希望以后可以用到 几种常用信号平滑去噪的方法 含普通噪声的数据的光滑普通噪声即随机的噪声，是一些比较随机的波动。我们可以做的只是让这些波动变得平均。要去除背景还得用测量的">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/untitled-20201224.png">
<meta property="article:published_time" content="2020-12-24T09:16:30.000Z">
<meta property="article:modified_time" content="2023-04-20T12:37:18.000Z">
<meta property="article:author" content="Zhaohua Tian">
<meta property="article:tag" content="MATLAB">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/untitled-20201224.png"><link rel="shortcut icon" href="/upload/ket.png"><link rel="canonical" href="https://knifelees3.github.io/2020/12/24/C_%E6%95%99%E7%A8%8B_MATLAB_%E5%85%89%E6%BB%91%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7c4710045c846acddf6f6813e3d1fa3e";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MATLAB光滑数据的方法总结',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-20 20:37:18'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/upload/ket.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">101</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/academatic/"><span> Academic</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/untitled-20201224.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Zhaohua Tian's Web"><span class="site-name">Zhaohua Tian's Web</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/academatic/"><span> Academic</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MATLAB光滑数据的方法总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-12-24T09:16:30.000Z" title="Created 2020-12-24 17:16:30">2020-12-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-04-20T12:37:18.000Z" title="Updated 2023-04-20 20:37:18">2023-04-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">965</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>3min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MATLAB光滑数据的方法总结"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="MATLAB-Dataprocessing"><a href="#MATLAB-Dataprocessing" class="headerlink" title="MATLAB #Dataprocessing"></a>MATLAB #Dataprocessing</h1><h2 id="MATLAB光滑数据的方法总结"><a href="#MATLAB光滑数据的方法总结" class="headerlink" title="MATLAB光滑数据的方法总结"></a>MATLAB光滑数据的方法总结</h2><p>对于数据的光滑，我开始理解的不透彻，直接用了一些MATLAB、Python的内置函数，没有理解其内在本质，仔细看了一些技术文章，了解了其基本原理，总结出来，希望以后可以用到</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42943114/article/details/107693068">几种常用信号平滑去噪的方法</a></p>
<h3 id="含普通噪声的数据的光滑"><a href="#含普通噪声的数据的光滑" class="headerlink" title="含普通噪声的数据的光滑"></a>含普通噪声的数据的光滑</h3><p>普通噪声即随机的噪声，是一些比较随机的波动。我们可以做的只是让这些波动变得<strong>平均</strong>。要去除背景还得用测量的结果减去背景才行。MATLAB内置了很多的函数，我们取其中的<code>smoothdata</code>,<code>filter</code>,<code>movmean</code>函数，另外还可以手动来做卷积，来比较结果的异同。<code>smoothdata</code>的处理含<code>movmean</code>的选项，所以我们直接用<code>smoothdata</code>函数即可。代码如下</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">x=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">10</span>,<span class="number">100</span>);</span><br><span class="line">y=<span class="built_in">exp</span>(-(x<span class="number">-5</span>).^<span class="number">2</span>)+ <span class="number">0.25</span>*<span class="built_in">rand</span>(<span class="built_in">size</span>(x));</span><br><span class="line">y_0=<span class="built_in">exp</span>(-(x<span class="number">-5</span>).^<span class="number">2</span>);</span><br><span class="line">window=<span class="number">5</span>;</span><br><span class="line">b = (<span class="number">1</span>/window)*<span class="built_in">ones</span>(<span class="number">1</span>,window);</span><br><span class="line">a = <span class="number">1</span>;</span><br><span class="line">y_smooth_gaussian=smoothdata(y,<span class="string">'gaussian'</span>,window);</span><br><span class="line">y_smooth_flitter=filter(b,a,y);</span><br><span class="line">y_smooth_cov=conv(y,b,<span class="string">'same'</span>);</span><br><span class="line">y_smooth_movemean=smoothdata(y,<span class="string">'movmean'</span>,window);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(x,y,<span class="string">'DisplayName'</span>,<span class="string">'noised data'</span>,<span class="string">'linewidth'</span>,<span class="number">1.5</span>)</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(x,y_smooth_gaussian,<span class="string">'DisplayName'</span>,<span class="string">'smoothdata'</span>,<span class="string">'linewidth'</span>,<span class="number">1.5</span>)</span><br><span class="line">grid on</span><br><span class="line"><span class="built_in">plot</span>(x,y_smooth_flitter,<span class="string">'DisplayName'</span>,<span class="string">'filter'</span>,<span class="string">'linewidth'</span>,<span class="number">1.5</span>)</span><br><span class="line">grid on</span><br><span class="line"><span class="built_in">plot</span>(x,y_smooth_cov,<span class="string">'DisplayName'</span>,<span class="string">'conver'</span>,<span class="string">'linewidth'</span>,<span class="number">1.5</span>)</span><br><span class="line">grid on</span><br><span class="line"><span class="built_in">plot</span>(x,y_smooth_movemean,<span class="string">'DisplayName'</span>,<span class="string">'movemean'</span>,<span class="string">'linewidth'</span>,<span class="number">1.5</span>)</span><br><span class="line">grid on</span><br><span class="line"><span class="built_in">plot</span>(x,y_0,<span class="string">'DisplayName'</span>,<span class="string">'without noise'</span>,<span class="string">'linewidth'</span>,<span class="number">1.5</span>)</span><br><span class="line">grid on</span><br><span class="line"><span class="built_in">legend</span>()</span><br><span class="line">xlabel(<span class="string">'x'</span>);ylabel(<span class="string">'y'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/untitled-20201224.png" alt=""></p>
<p>我们是在原函数的基础上加了背景，所以数据即使被光滑以后，也还是与源数据对不上。<strong>降噪</strong>此时只是减去了波动，而不是真的可以减去噪声。如果我们减去同样比例波动的噪声呢？</p>
<p><img src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/untitled-1608775388747.png" alt=""></p>
<p>发现结果就可以在源数据附近波动了。</p>
<p>从上面的结果还可以看见，<strong><code>movmean</code>相当于对于一个均匀的<code>窗口函数</code>做卷积，不过边界点<code>movmean</code>会又专门做特殊处理。</strong></p>
<h3 id="处理离群值（粗大误差）的方法"><a href="#处理离群值（粗大误差）的方法" class="headerlink" title="处理离群值（粗大误差）的方法"></a>处理离群值（粗大误差）的方法</h3><p>离群值是指在测量值中，出现了一些反常的值，这个反常值与附近的其它正常值差别非常大。实验中经常有一些异常值，比如我们的荧光实验中会有一些突然的亮点，这些值可能来自宇宙射线等，怎么处理掉这些值呢？</p>
<p>我这里主要想介绍标准差法和MAD法。</p>
<ul>
<li><p><strong>标准差法</strong>又叫做 3 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.292ex" height="1ex" role="img" focusable="false" viewBox="0 -431 571 442"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g></g></g></svg></mjx-container>法。目的是规定一个数据波动阈值，当数据超过这个阈值的时候，便认为该数据离群。这个方法阈值的选取方法，采用窗口数据的3倍标准差。</p>
</li>
<li><p><strong>MAD法</strong>也是定义了一个阈值，这个阈值叫做中位数绝对偏差MAD。如果超过了3倍的MAD，则认为该数据离群。</p>
</li>
</ul>
<p>两者在Matlab里，可以用<code>filloutliers()</code>函数进行实现。下面代码对比了标准差法和MAD法在消除离群值的效果:</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">t = <span class="number">0</span>:<span class="number">0.06</span>:<span class="number">10</span>;</span><br><span class="line">A = <span class="built_in">sin</span>(t)+<span class="number">0.1</span>*<span class="built_in">rand</span>(<span class="built_in">size</span>(t));</span><br><span class="line"></span><br><span class="line">Ri = randi(<span class="built_in">length</span>(t),<span class="number">4</span>,<span class="number">1</span>);</span><br><span class="line">A2 = A;</span><br><span class="line">A2(Ri) = A(Ri)*<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line">B2 = filloutliers(A2,<span class="string">'linear'</span>,<span class="string">'movmean'</span>,<span class="number">11</span>);<span class="comment">%标准差法</span></span><br><span class="line">B3 = filloutliers(A2,<span class="string">'linear'</span>,<span class="string">'movmedian'</span>,<span class="number">11</span>);<span class="comment">%MAD法</span></span><br><span class="line"></span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,A2)</span><br><span class="line">YL = ylim;</span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,B2)</span><br><span class="line">ylim(YL)</span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,B3)</span><br><span class="line">ylim(YL)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/untitled-1608776923927.png" alt=""></p>
<p>可以看见离群值通过<code>MAD</code>方法可以被非常有效的去除掉。</p>
<h3 id="兼顾去噪和去除离群噪声？"><a href="#兼顾去噪和去除离群噪声？" class="headerlink" title="兼顾去噪和去除离群噪声？"></a>兼顾去噪和去除离群噪声？</h3><p>MATLAB自带的函数<code>smoothdata</code>还有几种基于回归的方法，</p>
<blockquote>
<ul>
<li><code>'lowess'</code> — Linear regression over each window of <code>A</code>. This method can be computationally expensive, but results in fewer discontinuities.</li>
<li><code>'loess'</code> — Quadratic regression over each window of <code>A</code>. This method is slightly more computationally expensive than <code>'lowess'</code>.</li>
<li><code>'rlowess'</code> — Robust linear regression over each window of <code>A</code>. This method is a more computationally expensive version of the method <code>'lowess'</code>, but it is more robust to outliers.</li>
<li><code>'rloess'</code> — Robust quadratic regression over each window of <code>A</code>. This method is a more computationally expensive version of the method <code>'loess'</code>, but it is more robust to outlier</li>
</ul>
</blockquote>
<p><img src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/untitled-1608777604011.png" alt=""></p>
<p>从上面图可以看见，<code>loess</code>,<code>rlowess</code>可以兼顾噪声和光滑数据。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://knifelees3.github.io">Zhaohua Tian</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://knifelees3.github.io/2020/12/24/C_%E6%95%99%E7%A8%8B_MATLAB_%E5%85%89%E6%BB%91%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/">https://knifelees3.github.io/2020/12/24/C_%E6%95%99%E7%A8%8B_MATLAB_%E5%85%89%E6%BB%91%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MATLAB/">MATLAB</a></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/untitled-20201224.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/01/30/C_%E6%95%99%E7%A8%8B_MATLAB%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A2%9C%E8%89%B2%E6%9B%B2%E7%BA%BF/" title="MATLAB如何自定义颜色曲线"><img class="cover" src="https://matplotlib.org/3.1.0/_images/sphx_glr_colormaps_002.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">MATLAB如何自定义颜色曲线</div></div></a></div><div class="next-post pull-right"><a href="/2020/12/22/C_%E6%95%99%E7%A8%8B_Python%E7%9A%84CV2%E5%BA%93%E6%A3%80%E6%B5%8Btiff%E5%9B%BE%E5%BD%A2%E4%B8%AD%E7%9A%84%E5%9C%86%E5%BD%A2/" title="运用Python的CV2库检测tiff图形中的圆形"><img class="cover" src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/image-20201224173107821.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">运用Python的CV2库检测tiff图形中的圆形</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2020/06/20/A_En_DipoleEmissionNearSphere/" title="Dipole&#39;s Emission Near Sphere"><img class="cover" src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/20200107214942441_16601.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-20</div><div class="title">Dipole&#39;s Emission Near Sphere</div></div></a></div><div><a href="/2019/07/06/A_En_How_To_Use_COMSOL_LiveLink_With_MATLAB/" title="How to use COMSOL, MATLAB and COMSOL livelink with MATLAB on Server"><img class="cover" src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/icons/COMSOLICON.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-07-06</div><div class="title">How to use COMSOL, MATLAB and COMSOL livelink with MATLAB on Server</div></div></a></div><div><a href="/2019/04/07/A_En_MATLAB_FileOperationSummary/" title="MATLAB File Operation Summary"><img class="cover" src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/icons/MATLABICON.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-04-07</div><div class="title">MATLAB File Operation Summary</div></div></a></div><div><a href="/2019/04/17/A_En_MATLAB_ParallelComputing/" title="MATLAB Parallel Computing Summary"><img class="cover" src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/icons/MATLABICON.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-04-17</div><div class="title">MATLAB Parallel Computing Summary</div></div></a></div><div><a href="/2019/04/06/A_En_MATLAB_PlotSummary1_1dLinePlots/" title="Data Visualization Via MATALB (1d line plots)"><img class="cover" src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/20190406_MATLAB_PLOT/example_03_1d.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-04-06</div><div class="title">Data Visualization Via MATALB (1d line plots)</div></div></a></div><div><a href="/2019/12/30/A_En_MATLAB_PlotSummary2_3dContourPlots/" title="Data Visualization Via MATLAB (3 dimensional data)"><img class="cover" src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/sym_distri_static_MATLAB.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-12-30</div><div class="title">Data Visualization Via MATLAB (3 dimensional data)</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/upload/ket.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Zhaohua Tian</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">101</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">46</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://www.zhihu.com/people/knife-lee-94"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">ZhaohuaTian's personal blog/个人小站</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MATLAB-Dataprocessing"><span class="toc-number">1.</span> <span class="toc-text">MATLAB #Dataprocessing</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MATLAB%E5%85%89%E6%BB%91%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93"><span class="toc-number">1.1.</span> <span class="toc-text">MATLAB光滑数据的方法总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AB%E6%99%AE%E9%80%9A%E5%99%AA%E5%A3%B0%E7%9A%84%E6%95%B0%E6%8D%AE%E7%9A%84%E5%85%89%E6%BB%91"><span class="toc-number">1.1.1.</span> <span class="toc-text">含普通噪声的数据的光滑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E7%A6%BB%E7%BE%A4%E5%80%BC%EF%BC%88%E7%B2%97%E5%A4%A7%E8%AF%AF%E5%B7%AE%EF%BC%89%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.2.</span> <span class="toc-text">处理离群值（粗大误差）的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%BC%E9%A1%BE%E5%8E%BB%E5%99%AA%E5%92%8C%E5%8E%BB%E9%99%A4%E7%A6%BB%E7%BE%A4%E5%99%AA%E5%A3%B0%EF%BC%9F"><span class="toc-number">1.1.3.</span> <span class="toc-text">兼顾去噪和去除离群噪声？</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/14/E_%E7%89%A9%E7%90%86_%E9%9D%9E%E6%AD%A3%E4%BA%A4%E5%9F%BA%E7%9F%A2%E5%B1%95%E5%BC%80%E7%9A%84%E6%96%B9%E6%B3%95/" title="如何正确使用非正交基矢展开某个矢量"><img src="https://en.wikipedia.org/wiki/File:Orthogonality_and_rotation.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何正确使用非正交基矢展开某个矢量"/></a><div class="content"><a class="title" href="/2025/09/14/E_%E7%89%A9%E7%90%86_%E9%9D%9E%E6%AD%A3%E4%BA%A4%E5%9F%BA%E7%9F%A2%E5%B1%95%E5%BC%80%E7%9A%84%E6%96%B9%E6%B3%95/" title="如何正确使用非正交基矢展开某个矢量">如何正确使用非正交基矢展开某个矢量</a><time datetime="2025-09-14T05:15:30.000Z" title="Created 2025-09-14 13:15:30">2025-09-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/15/E_%E7%89%A9%E7%90%86_20YearsNanoOptics/" title="Sympoisum 20 Years Nano Optics Pioneer Interview Collections"><img src="https://mpl.mpg.de/fileadmin/_processed_/b/b/csm_csm_PosterNanoOptics_1205_b3e9b30b98_8bd88f2d16.gif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Sympoisum 20 Years Nano Optics Pioneer Interview Collections"/></a><div class="content"><a class="title" href="/2025/02/15/E_%E7%89%A9%E7%90%86_20YearsNanoOptics/" title="Sympoisum 20 Years Nano Optics Pioneer Interview Collections">Sympoisum 20 Years Nano Optics Pioneer Interview Collections</a><time datetime="2025-02-15T15:32:30.000Z" title="Created 2025-02-15 23:32:30">2025-02-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/17/E_%E7%89%A9%E7%90%86_%E6%97%8B%E8%BD%ACFrame%E4%B8%8B%E5%93%88%E5%AF%86%E9%A1%BF%E9%87%8F%E7%9A%84%E8%A1%A8%E7%A4%BA/" title="旋转Frame下哈密顿量的表示"><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1470180402800037-gr2.gif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="旋转Frame下哈密顿量的表示"/></a><div class="content"><a class="title" href="/2025/01/17/E_%E7%89%A9%E7%90%86_%E6%97%8B%E8%BD%ACFrame%E4%B8%8B%E5%93%88%E5%AF%86%E9%A1%BF%E9%87%8F%E7%9A%84%E8%A1%A8%E7%A4%BA/" title="旋转Frame下哈密顿量的表示">旋转Frame下哈密顿量的表示</a><time datetime="2025-01-17T12:29:30.000Z" title="Created 2025-01-17 20:29:30">2025-01-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/28/E_%E7%89%A9%E7%90%86_%E5%B8%B8%E8%A7%81%E5%8D%95%E5%85%89%E5%AD%90%E6%BA%90%E7%A7%8D%E7%B1%BB/" title="典型单光子源以及光子波形"><img src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picblog/Snipaste_2025-02-12_00-04-09.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="典型单光子源以及光子波形"/></a><div class="content"><a class="title" href="/2024/10/28/E_%E7%89%A9%E7%90%86_%E5%B8%B8%E8%A7%81%E5%8D%95%E5%85%89%E5%AD%90%E6%BA%90%E7%A7%8D%E7%B1%BB/" title="典型单光子源以及光子波形">典型单光子源以及光子波形</a><time datetime="2024-10-28T14:28:30.000Z" title="Created 2024-10-28 22:28:30">2024-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/05/E_%E7%89%A9%E7%90%86_%E5%A6%82%E4%BD%95%E5%87%8F%E5%B0%91%E7%A7%91%E7%A0%94%E4%B8%AD%E7%9A%84%E9%94%99%E8%AF%AF/" title="如何减少科研中的错误"><img src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/WrittingFigures.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何减少科研中的错误"/></a><div class="content"><a class="title" href="/2024/09/05/E_%E7%89%A9%E7%90%86_%E5%A6%82%E4%BD%95%E5%87%8F%E5%B0%91%E7%A7%91%E7%A0%94%E4%B8%AD%E7%9A%84%E9%94%99%E8%AF%AF/" title="如何减少科研中的错误">如何减少科研中的错误</a><time datetime="2024-09-05T01:26:30.000Z" title="Created 2024-09-05 09:26:30">2024-09-05</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Zhaohua Tian</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'jR8sBuhmF2OQvpAqh8LWCbt1-gzGzoHsz',
      appKey: '2C5ChxH3zGFNoQ8rO7u9I2Lb',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>